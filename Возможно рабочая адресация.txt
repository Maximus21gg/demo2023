Сегменты
   WEB-L - 192.168.100.0/24
   SRV - 192.168.100.0/24
   RTR-L - 192.168.100.0/24, 4.4.4.0/24
   ISP - 4.4.4.0/24, 3.3.3.0/24, 5.5.5.0/24 
   CLI - 3.3.3.0/24
   RTR-R - 5.5.5.0/24, 172.16.100.0/24 
   WEB-R - 172.16.100.0/24
1) Адресация

  a) WEB-L
      192.168.100.0/24
      IP - 192.168.100.100/24
      GATEWAY - 192.168.100.254
      DNS - 192.168.1.1
      A DNS - 8.8.8.8

  b) SRV
      IP - 192.168.100.200
      GATEWAY - 192.168.100.254
      DNS - 192.168.1.1
      A DNS - 192.168.100.200

  Включить правила в firewall - общий доступ к файлам и принтерам - ICMPv4

  c) RTR-L
     192.168.100.0/24
     IP - 192.168.100.254/24

     4.4.4.0/24
     IP - 4.4.4.100/24
     GATEWAY - 4.4.4.1
     DNS - 192.168.1.1
     A DNS - 8.8.8.8

  d) ISP
     4.4.4.0/24
     IP - 4.4.4.1/24
     DNS - 192.168.1.1

     3.3.3.0/24
     IP - 3.3.3.1/24
     DNS - 192.168.1.1

     5.5.5.0/24
     IP - 5.5.5.1/24
     DNS - 192.168.1.1
     
     192.168.1.0/24
     IP - 192.168.1.10/24
     GATEWAY - 192.168.1.1
     DNS - 192.168.1.1

  e) CLI 
     IP - 3.3.3.10/24
     GATEWAY - 3.3.3.1
     DNS - 192.168.1.1
     A DNS - 3.3.3.1

  Включить правила в firewall - общий доступ к файлам и принтерам - ICMPv4 

  e) RTR-R 
     5.5.5.0/24 
     IP - 5.5.5.100/24
     GATEWAY - 5.5.5.1
     DNS - 192.168.1.1
     A DNS - 8.8.8.8

     172.16.100.0/24
     IP - 172.16.100.254

  f) WEB-R
     172.16.100.0/24
     IP - 172.16.100.200/24
     GATEWAY - 172.16.100.254
     DNS - 192.168.1.1

   2) Firewall

   a) ISP
      nano /etc/sysctl.conf
      #net.ipv4.ip_forward=1 Раскомментировать
      sysctl -p
      systemctl restart networking

      iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
      iptables -A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT
      iptables -t filter -A FORWARD -p icmp -j ACCEPT
      iptables -t nat -A POSTROUTING -s 3.3.3.0/24 -j MASQUERADE
      iptables -t nat -A POSTROUTING -s 4.4.4.0/24 -j MASQUERADE
      iptables -t nat -A POSTROUTING -s 5.5.5.0/24 -j MASQUERADE
      iptables -A FORWARD -p tcp -m multiport --ports 22,53,80,8080,443,110,25,21 -s 3.3.3.0/24 -j ACCEPT
      
      iptables -A FORWARD -p tcp -m multiport --ports 22,53,80,8080,443,110,25,21 -s 4.4.4.0/24 -j ACCEPT
      
      iptables -A FORWARD -p tcp -m multiport --ports 22,53,80,8080,443,110,25,21 -s 5.5.5.0/24 -j ACCEPT
      
      iptables-save
      iptables-save > iptables.backupv2
      iptables-restore < iptables.backupv2
      apt install iptables-persistent программа для автоматического восстановления 
      правил
      Проверка: ping 192.168.1.1, ping ya.ru
   b)RTR-L
      iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
      iptables -A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT
      iptables -t filter -A FORWARD -p icmp -j ACCEPT
      iptables -t nat -A POSTROUTING -s 192.168.100.0/24 -j MASQUERADE
      iptables -A FORWARD -p tcp -m multiport --ports 22,53,80,8080,443,110,25,21 -s 192.168.100.0/24 -j ACCEPT
      
      iptables-save
      iptables-save > iptables.backupv2
      iptables-restore < iptables.backupv2
      apt install iptables-persistent
      apt install iptables-persistent программа для автоматического восстановления
      правил
   c) RTR-R
      iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
      iptables -A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT
      iptables -t filter -A FORWARD -p icmp -j ACCEPT
      iptables -t nat -A POSTROUTING -s 172.16.100.0/24 -j MASQUERADE
      iptables -A FORWARD -p tcp -m multiport --ports 22,53,80,8080,443,110,25,21 -s 172.16.100.0/24 -j ACCEPT

      iptables-save
      iptables-save > iptables.backupv2 сохранение правил
      iptables-restore < iptables.backupv2 загрузка правил из сохранённого файла
      apt install iptables-persistent программа для автоматического восстановления 
      правил
      Проверка: ping 192.168.1.1, ping ya.ru


   3) GRE 

      a) RTR-L, RTR-R


      a) RTR-L 

      nmtui - добавить - Туннель IP

      Имя профиля - link RTR-R 
      Устройство Tunnel1
      Parent - интерфейс 4.4.4.100 - ens***
      Режим - GRE
      Локальный IP - 4.4.4.100
      Удалённый IP - 5.5.5.100
      
      IPv4 - вручную - показать
      IP - 10.5.5.1/30

      b) RTR-R

      nmtui - добавить - Туннель IP

      Имя профиля - link RTR-L 
      Устройство Tunnel1
      Режим - GRE
      Parent - интерфейс 5.5.5.100 - ens***
      Локальный IP - 5.5.5.100
      Удалённый IP - 4.4.4.100
      
      IPv4 - вручную - показать
      IP - 10.5.5.2/30


      4) SSH - Не знаю







